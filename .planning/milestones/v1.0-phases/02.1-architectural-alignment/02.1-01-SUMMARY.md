---
phase: 02.1-architectural-alignment
plan: 01
subsystem: infra
tags: [imports, shims, adapter, refactoring, backward-compat]

# Dependency graph
requires:
  - phase: PORT
    provides: "src/adapters/ canonical directory structure with re-export shims in src/adapter/"
provides:
  - "All imports point to canonical src/adapters/ paths (no shims)"
  - "Removed src/adapter/ (singular) shim directory"
  - "Removed src/types/ shim directory"
  - "Relocated openclaw-adapter test to test/unit/adapters/openclaw/"
affects: [02.1-02, 02.1-03, 02.1-04, 03-hardening]

# Tech tracking
tech-stack:
  added: []
  patterns: [canonical-imports-only, no-backward-compat-shims]

key-files:
  created:
    - "test/unit/adapters/openclaw/openclaw-adapter.test.ts"
  modified:
    - "src/audit/integrity-service.ts"
    - "src/cli/commands.ts"

key-decisions:
  - "Use PlatformAdapter (canonical name) instead of CareAgentPluginAPI (deprecated alias) in commands.ts"
  - "tsc --noEmit pre-existing failures unrelated to this plan (node: module resolution); verified same errors exist before and after changes"

patterns-established:
  - "Canonical imports only: all source/test files import from src/adapters/ (plural), never src/adapter/ (singular)"
  - "Test directory mirrors source: test/unit/adapters/openclaw/ matches src/adapters/openclaw/"

# Metrics
duration: 169s
completed: 2026-02-19
---

# Phase 2.1 Plan 01: Remove Stale Import Shims Summary

**Eliminated backward-compat shim directories (src/adapter/, src/types/) and updated all imports to canonical src/adapters/ paths**

## Performance

- **Duration:** 169s (~3 min)
- **Started:** 2026-02-19T14:31:02Z
- **Completed:** 2026-02-19T14:33:51Z
- **Tasks:** 2
- **Files modified:** 8 (3 updated, 4 deleted, 1 created)

## Accomplishments
- Updated 2 source files (integrity-service.ts, commands.ts) to import from canonical src/adapters/types.ts
- Renamed CareAgentPluginAPI usage to PlatformAdapter in commands.ts function signature
- Relocated openclaw-adapter test from test/unit/adapter/ to test/unit/adapters/openclaw/ with updated import path
- Deleted 3 deprecated directories: src/adapter/, src/types/, test/unit/adapter/
- All 426 tests pass, build succeeds with all 4 entry points

## Task Commits

Each task was committed atomically:

1. **Task 1: Fix stale imports in source and test files** - `b0425fc` (refactor)
2. **Task 2: Remove deprecated shim directories** - `553e72d` (refactor)

## Files Created/Modified
- `src/audit/integrity-service.ts` - Updated ServiceConfig import from adapters/types.js
- `src/cli/commands.ts` - Updated PlatformAdapter import from adapters/types.js, renamed type in signature
- `test/unit/adapters/openclaw/openclaw-adapter.test.ts` - Relocated test with canonical import path
- `src/adapter/types.ts` - DELETED (was re-export shim)
- `src/adapter/openclaw-adapter.ts` - DELETED (was re-export shim)
- `src/types/index.ts` - DELETED (was re-export shim)
- `src/types/cans.ts` - DELETED (was re-export shim)
- `test/unit/adapter/openclaw-adapter.test.ts` - DELETED (old location)

## Decisions Made
- Used PlatformAdapter (canonical name) instead of CareAgentPluginAPI (deprecated alias) when updating commands.ts, since new code should use the canonical name per PORT decision
- Confirmed tsc --noEmit failures are pre-existing (node: module resolution, missing @types/node) and not caused by this plan's changes

## Deviations from Plan

None - plan executed exactly as written.

Note: The plan referenced "388 tests" but the actual count is 426, because other plans in phase 02.1 (02-04) have already executed and added tests. All 426 tests pass.

## Issues Encountered
None

## User Setup Required
None - no external service configuration required.

## Next Phase Readiness
- Codebase is clean: no backward-compat shims remain
- All imports use canonical paths (src/adapters/ plural)
- Test structure mirrors source structure
- Ready for subsequent 02.1 plans and Phase 3 hardening

## Self-Check: PASSED

- All created files verified present
- All deleted files verified absent
- All commit hashes verified in git log

---
*Phase: 02.1-architectural-alignment*
*Completed: 2026-02-19*
