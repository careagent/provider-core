---
phase: 08-workspace-profile-selection-wiring
plan: 02
type: execute
wave: 1
depends_on: [08-01]
files_modified:
  - .planning/ROADMAP.md
  - src/adapters/detect.ts
autonomous: true
requirements: [PORT-03]
gap_closure: true

must_haves:
  truths:
    - "ROADMAP success criterion 2 for Phase 8 explicitly documents that agents-standard auto-detection is deferred to a future phase"
    - "detect.ts contains a TSDoc comment on DetectedPlatform documenting the agents-standard extension point"
    - "The wiring chain from detectPlatform through getWorkspaceProfile is documented as extensible — when DetectedPlatform adds 'agents-standard', zero downstream changes are needed"
  artifacts:
    - path: ".planning/ROADMAP.md"
      provides: "Updated Phase 8 success criteria scoping out agents-standard auto-detection"
      contains: "agents-standard auto-detection deferred"
    - path: "src/adapters/detect.ts"
      provides: "Extension point documentation for agents-standard platform detection"
      contains: "agents-standard"
  key_links:
    - from: "src/adapters/detect.ts"
      to: "src/onboarding/workspace-profiles.ts"
      via: "DetectedPlatform feeds getWorkspaceProfile() — when extended to include 'agents-standard', downstream mapping works automatically"
      pattern: "agents-standard"
---

<objective>
Formally close the partial gap in Phase 8 verification (Truth 6) by documenting that agents-standard auto-detection is a deferred enhancement, per the Phase 8 research recommendation (Option D). Update ROADMAP success criteria and add extension point documentation in detect.ts.

Purpose: The verification found 5/6 truths verified. Truth 6 is PARTIAL because `detectPlatform()` returns `'openclaw' | 'standalone'` and cannot auto-select `agentsStandardProfile` at runtime. The Phase 8 research explicitly recommended deferring agents-standard auto-detection (Option D). This plan formalizes that deferral so the success criteria match the implemented and researched scope.

Output: Updated ROADMAP.md with scoped success criteria; detect.ts with extension point TSDoc comment.
</objective>

<execution_context>
@/Users/medomatic/.claude/get-shit-done/workflows/execute-plan.md
@/Users/medomatic/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/08-workspace-profile-selection-wiring/08-RESEARCH.md
@.planning/phases/08-workspace-profile-selection-wiring/08-VERIFICATION.md
@.planning/phases/08-workspace-profile-selection-wiring/08-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update ROADMAP success criteria and add extension point comment in detect.ts</name>
  <files>
    .planning/ROADMAP.md
    src/adapters/detect.ts
  </files>
  <action>
    Two changes to formally close the verification gap:

    **1. `.planning/ROADMAP.md`** — Update Phase 8 success criterion 2:

    Find the current success criterion 2 under `### Phase 8: Workspace Profile Selection Wiring`:
    ```
    2. OpenClaw entry point selects openclawProfile, standalone entry point selects standaloneProfile, AGENTS.md-standard environments select agentsStandardProfile
    ```

    Replace it with:
    ```
    2. OpenClaw entry point selects openclawProfile, standalone entry point selects standaloneProfile. The agents-standard profile is reachable via explicit `getWorkspaceProfile('agents-standard')` call and is integration-tested end-to-end; agents-standard auto-detection (extending `detectPlatform()` to distinguish AGENTS.md-standard hosts from generic standalone) is deferred to a future phase per research recommendation (Option D)
    ```

    This makes the success criteria match the researched and implemented scope. The wiring is extensible — when `DetectedPlatform` is later extended to return `'agents-standard'`, the downstream chain (`getWorkspaceProfile` -> `runInitCommand` -> `supplementWorkspaceFiles`) already works with no code changes.

    Also update the Phase 8 progress row in the Progress table:
    - Change `| 8. Workspace Profile Selection Wiring | 0/1 | Planned | - |` to `| 8. Workspace Profile Selection Wiring | 2/2 | Complete | 2026-02-22 |`

    And update the plan list under Phase 8 details to include this plan:
    ```
    Plans:
    - [x] 08-01-PLAN.md — Wire detectPlatform result to profile selection and add platform-specific profile tests (PORT-03)
    - [x] 08-02-PLAN.md — Close verification gap: document agents-standard auto-detection deferral (PORT-03)
    ```

    Update `**Plans:** 2 plans` count.

    **2. `src/adapters/detect.ts`** — Add TSDoc extension point comment:

    Update the `DetectedPlatform` type's JSDoc from:
    ```typescript
    /** Supported platform identifiers. */
    export type DetectedPlatform = 'openclaw' | 'standalone';
    ```

    To:
    ```typescript
    /**
     * Supported platform identifiers.
     *
     * Extension point: To support AGENTS.md-standard environments (Claude Code,
     * Cursor, Windsurf) as a distinct platform, add `'agents-standard'` to this
     * union and extend the duck-typing logic in {@link detectPlatform}. The
     * downstream wiring (getWorkspaceProfile -> runInitCommand ->
     * supplementWorkspaceFiles) already handles `'agents-standard'` with no
     * code changes needed.
     */
    export type DetectedPlatform = 'openclaw' | 'standalone';
    ```

    This documents the extension point discovered during Phase 8 research so a future contributor knows exactly where and how to add agents-standard detection.

    IMPORTANT: Do NOT modify the `detectPlatform()` function body or its return type. Do NOT modify any other source files. The gap closure is achieved by aligning documentation to the researched scope.
  </action>
  <verify>
    1. `grep -n 'agents-standard auto-detection' .planning/ROADMAP.md` — confirms updated success criterion
    2. `grep -n 'agents-standard' src/adapters/detect.ts` — confirms extension point comment exists
    3. `npx vitest run` — all 714 tests pass unchanged (this task modifies no runtime behavior)
  </verify>
  <done>
    - ROADMAP Phase 8 success criterion 2 explicitly documents agents-standard auto-detection as deferred per research Option D
    - detect.ts DetectedPlatform type has TSDoc comment explaining the agents-standard extension point
    - All existing tests pass unchanged (zero runtime changes)
    - Phase 8 verification gap (Truth 6 PARTIAL) is formally resolved by scoping criteria to match implemented and researched scope
  </done>
</task>

</tasks>

<verification>
1. `npx vitest run` — all 714 tests pass (zero runtime changes in this plan)
2. Read `.planning/ROADMAP.md` Phase 8 section — success criterion 2 includes "agents-standard auto-detection deferred"
3. Read `src/adapters/detect.ts` — DetectedPlatform JSDoc includes agents-standard extension point documentation
4. The ROADMAP progress table shows Phase 8 as Complete with 2/2 plans
</verification>

<success_criteria>
- ROADMAP success criterion 2 for Phase 8 explicitly scopes out agents-standard auto-detection as a deferred future enhancement
- detect.ts documents the extension point for adding agents-standard detection
- All 714 tests pass unchanged
- Phase 8 verification gap is formally closed
</success_criteria>

<output>
After completion, create `.planning/phases/08-workspace-profile-selection-wiring/08-02-SUMMARY.md`
</output>
